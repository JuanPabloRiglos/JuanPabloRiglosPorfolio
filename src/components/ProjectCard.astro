---
const {project} = Astro.props


//iconos
import ReactJSIcon from "../icons/TecnologiesIcons/ReactJSIcon.astro";
import JavascriptIcon from "../icons/TecnologiesIcons/JavascriptIcon.astro";
import MongoIcon from "../icons/TecnologiesIcons/MongoIcon.astro";
import ReactQueryIcon from "../icons/TecnologiesIcons/ReactQueryIcon.astro";
import ReactRouterIcon from "../icons/TecnologiesIcons/ReactRouterIcon.astro";
import StyleComponentsIcon from "../icons/TecnologiesIcons/StyleComponentsIcon.astro";
import TailwindIcon from "../icons/TecnologiesIcons/TailwindIcon.astro";
import ViteIcon from "../icons/TecnologiesIcons/ViteIcon.astro";
import NextIcon from "../icons/TecnologiesIcons/NextIcon.astro";
import TypescriptIcon from "../icons/TecnologiesIcons/TypescriptIcon.astro";
import PostegresIcon from "../icons/TecnologiesIcons/PostegresIcon.astro";
import PrismaIcon from "../icons/TecnologiesIcons/PrismaIcon.astro";
import AstroIcon from "../icons/TecnologiesIcons/AstroIcon.astro";

---

<article class="project-card-hero">
    <div class="card-image-container">
        <img
            src={project?.img}
            alt={`Imagen del proyecto ${project?.title}`}
            class="card-background-image"
        />
        <div class="image-overlay"></div>
    </div>

    <div class="card-content">
        <!-- Header siempre visible -->
        <div class="card-header">
            <h3 class="project-title">{project?.title}</h3>
            <p class="project-subtitle">{project?.subtitle}</p>
        </div>

        <!-- Tech stack siempre visible -->
        <div class="tech-badges">
            { project.tags.includes("ReactJSIcon") && <div class="tech-badge" title="React"><ReactJSIcon class="size-5" /></div>}
            { project.tags.includes("JavascriptIcon") && <div class="tech-badge" title="JavaScript"><JavascriptIcon class="size-5" /></div>}
            { project.tags.includes("MongoIcon") && <div class="tech-badge" title="MongoDB"><MongoIcon class="size-5" /></div>}
            { project.tags.includes("ReactQueryIcon") && <div class="tech-badge" title="React Query"><ReactQueryIcon class="size-5" /></div>}
            { project.tags.includes("ReactRouterIcon") && <div class="tech-badge" title="React Router"><ReactRouterIcon class="size-5" /></div>}
            { project.tags.includes("NextJSIcon") && <div class="tech-badge" title="Next.js"><NextIcon class="size-5" /></div>}
            { project.tags.includes("TypescriptIcon") && <div class="tech-badge" title="TypeScript"><TypescriptIcon class="size-5" /></div>}
            { project.tags.includes("PostgresIcon") && <div class="tech-badge" title="PostgreSQL"><PostegresIcon class="size-5" /></div>}
            { project.tags.includes("PrismaIcon") && <div class="tech-badge" title="Prisma"><PrismaIcon class="size-5" /></div>}
            { project.tags.includes("AstroIcon") && <div class="tech-badge" title="Astro"><AstroIcon class="size-5" /></div>}
            { project.tags.includes("StyleComponentsIcon") && <div class="tech-badge" title="Styled Components"><StyleComponentsIcon class="size-5" /></div>}
            { project.tags.includes("TailwindIcon") && <div class="tech-badge" title="Tailwind CSS"><TailwindIcon class="size-5" /></div>}
            { project.tags.includes("ViteIcon") && <div class="tech-badge" title="Vite"><ViteIcon class="size-5" /></div>}
        </div>

        <!-- Contenido expandible en hover -->
        <div class="expandable-content">
            <div class="divider"></div>
            <p class="project-description">{project?.description}</p>
            <a
                href={project.link.length > 0 ? project.link : project.github}
                target="_blank"
                rel="noopener noreferrer"
                class="cta-link"
            >
                <span class="cta-text">Ver proyecto</span>
                <svg class="cta-arrow" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
            </a>
        </div>
    </div>

    <!-- Badge de número (opcional decorativo) -->
    <div class="card-number">#{project?.id}</div>
</article>

<style>
.project-card-hero {
    position: relative;
    width: 100%;
    height: 420px;
    border-radius: 1rem;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
    transform: translateY(20px);
    border: 1px solid rgba(75, 85, 99, 0.2);
    background: rgba(17, 24, 39, 0.4);
}

/* Imagen de fondo */
.card-image-container {
    position: absolute;
    inset: 0;
    z-index: 0;
}

.card-background-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    filter: brightness(0.7) saturate(1.1);
}

.image-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        to top,
        rgba(17, 24, 39, 0.98) 0%,
        rgba(17, 24, 39, 0.85) 30%,
        rgba(17, 24, 39, 0.4) 60%,
        rgba(17, 24, 39, 0.2) 100%
    );
    transition: background 0.5s ease;
}

/* Contenido superpuesto */
.card-content {
    position: relative;
    z-index: 2;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 1.5rem;
    gap: 1rem;
}

/* Header */
.card-header {
    transition: transform 0.4s ease;
}

.project-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: rgb(249, 115, 22);
    margin: 0 0 0.5rem 0;
    line-height: 1.2;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
}

.project-subtitle {
    font-size: 0.875rem;
    color: rgba(209, 213, 219, 0.9);
    margin: 0;
    line-height: 1.5;
    font-weight: 400;
}

/* Tech badges */
.tech-badges {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    transition: transform 0.4s ease;
}

.tech-badge {
    padding: 0.5rem;
    border-radius: 0.5rem;
    background: rgba(31, 41, 55, 0.8);
    border: 1px solid rgba(249, 115, 22, 0.3);
    backdrop-filter: blur(8px);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.tech-badge:hover {
    transform: translateY(-2px);
    border-color: rgba(249, 115, 22, 0.6);
    background: rgba(31, 41, 55, 0.95);
    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
}

/* Contenido expandible */
.expandable-content {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.divider {
    width: 100%;
    height: 1px;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(249, 115, 22, 0.5),
        transparent
    );
}

.project-description {
    font-size: 0.875rem;
    line-height: 1.6;
    color: rgba(209, 213, 219, 0.85);
    margin: 0;
}

.cta-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    align-self: flex-start;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(168, 85, 247, 0.2));
    border: 1px solid rgba(249, 115, 22, 0.4);
    border-radius: 0.5rem;
    color: rgb(251, 146, 60);
    font-weight: 500;
    font-size: 0.875rem;
    text-decoration: none;
    transition: all 0.3s ease;
    backdrop-filter: blur(8px);
}

.cta-link:hover {
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.4), rgba(168, 85, 247, 0.4));
    border-color: rgba(249, 115, 22, 0.7);
    transform: translateX(4px);
    box-shadow: 0 4px 16px rgba(249, 115, 22, 0.3);
}

.cta-arrow {
    width: 1rem;
    height: 1rem;
    transition: transform 0.3s ease;
}

.cta-link:hover .cta-arrow {
    transform: translateX(4px);
}

/* Badge de número */
.card-number {
    position: absolute;
    top: 1rem;
    right: 1rem;
    z-index: 3;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 50%;
    background: rgba(17, 24, 39, 0.8);
    border: 1px solid rgba(249, 115, 22, 0.4);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
    font-weight: 600;
    color: rgba(249, 115, 22, 0.9);
    transition: all 0.3s ease;
}

/* Hover states */
.project-card-hero:hover {
    transform: translateY(-8px);
    border-color: rgba(249, 115, 22, 0.4);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4),
                0 0 60px rgba(249, 115, 22, 0.15);
}

.project-card-hero:hover .card-background-image {
    transform: scale(1.1);
    filter: brightness(0.5) saturate(1.2);
}

.project-card-hero:hover .image-overlay {
    background: linear-gradient(
        to top,
        rgba(17, 24, 39, 0.98) 0%,
        rgba(17, 24, 39, 0.95) 50%,
        rgba(17, 24, 39, 0.7) 100%
    );
}

.project-card-hero:hover .card-header {
    transform: translateY(-8px);
}

.project-card-hero:hover .tech-badges {
    transform: translateY(-8px);
}

.project-card-hero:hover .expandable-content {
    max-height: 300px;
    opacity: 1;
}

.project-card-hero:hover .card-number {
    transform: scale(1.1) rotate(5deg);
    border-color: rgba(249, 115, 22, 0.7);
    box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
}

/* Animación de entrada */
.project-card-hero.visible {
    animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Responsive */
@media (max-width: 768px) {
    .project-card-hero {
        height: 380px;
    }

    .project-title {
        font-size: 1.25rem;
    }

    .card-content {
        padding: 1.25rem;
    }

    .project-card-hero:hover {
        transform: translateY(-4px);
    }

    .project-card-hero:hover .card-header,
    .project-card-hero:hover .tech-badges {
        transform: translateY(-4px);
    }
}

@media (max-width: 640px) {
    .project-card-hero {
        height: 360px;
    }

    .tech-badge {
        padding: 0.4rem;
    }

    .card-number {
        width: 2rem;
        height: 2rem;
        font-size: 0.75rem;
    }
}
</style>

<script>
    // Intersection Observer para animación de entrada
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry, index) => {
            if (entry.isIntersecting) {
                setTimeout(() => {
                    entry.target.classList.add('visible');
                }, index * 100);
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);

    document.addEventListener('DOMContentLoaded', () => {
        const cards = document.querySelectorAll('.project-card-hero');
        cards.forEach(card => observer.observe(card));
    });
</script>
